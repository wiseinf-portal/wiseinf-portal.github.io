"use strict";(self.webpackChunkportal=self.webpackChunkportal||[]).push([[147],{87254:function(B,M,t){var K=t(93236),h=t(62086),A=function(I){var y=I.children,v={backgroundColor:"#ffffcc",color:"#FFA500",padding:"10px",borderRadius:"4px",margin:"10px 0",maxWidth:"600px",border:"1px solid #ffcc66"};return(0,h.jsx)("div",{style:v,children:y})};M.Z=A},72520:function(B,M,t){t.r(M),t.d(M,{AccessKeyPage:function(){return C}});var K=t(67855),h=t.n(K),A=t(13448),u=t.n(A),I=t(74815),y=t.n(I),v=t(28152),x=t.n(v),E=t(19496),T=t(92790),k=t(26768),U=t(96762),W=t(36803),L=t(26245),w=t(60822),g=t(9034),S=t(25624),f=t(64619),P=t(93236),Z=t(37632),D=t(87254),O=t(66768),n=t(62086),C=function(){var s=(0,w.useIntl)(),l=(0,P.useRef)(),$=(0,P.useState)([]),j=x()($,2),m=j[0],R=j[1],z=(0,O.D3)(),p=z.getAccessTokenSilently,F=function(){var d=y()(u()().mark(function r(){var e;return u()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,p({detailedResponse:!0});case 2:e=_.sent,g.a.createAccessKey({withCredentials:!0,headers:{Authorization:"Bearer "+e.id_token}}).then(function(c){var a;(0,f.Ii)("success",s.formatMessage({id:"components.notification.title.success",defaultMessage:"\u6210\u529F"}),s.formatMessage({id:"api.accesskey.createAccessKey.success",defaultMessage:"\u6210\u529F\u521B\u5EFAAccess Key\u3002"})),l==null||(a=l.current)===null||a===void 0||a.reload()}).catch(function(c){var a=c;(0,f.hA)(s.formatMessage({id:"components.notification.title.error",defaultMessage:"\u9519\u8BEF"}),s.formatMessage({id:"api.accesskey.createAccessKey.failed",defaultMessage:"\u521B\u5EFAAccess Key \u5931\u8D25\u3002"}),a,s)});case 4:case"end":return _.stop()}},r)}));return function(){return d.apply(this,arguments)}}(),G=function(){var d=y()(u()().mark(function r(){var e,i,_;return u()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,p({detailedResponse:!0});case 3:return e=a.sent,a.next=6,g.a.listAccessKeys({withCredentials:!0,headers:{Authorization:"Bearer "+e.id_token}});case 6:if(i=a.sent,i.status!=200){a.next=15;break}if(!(i.data.length>0)){a.next=12;break}return a.abrupt("return",{data:i.data});case 12:return a.abrupt("return",{data:[]});case 13:a.next=16;break;case 15:(0,f.Ii)("error",s.formatMessage({id:"components.notification.title.error",defaultMessage:"\u9519\u8BEF"}),s.formatMessage({id:"api.accesskey.listAccessKeys.failed",defaultMessage:"\u83B7\u53D6\u7528\u6237Access Key\u6570\u636E\u5931\u8D25\uFF0C\u8BF7\u5237\u65B0\u9875\u9762\uFF0C\u91CD\u65B0\u5C1D\u8BD5\u3002\u72B6\u6001\u7801\uFF1A{code}({text})"},{code:i.status,text:i.statusText}));case 16:a.next=22;break;case 18:a.prev=18,a.t0=a.catch(0),_=a.t0,(0,f.hA)(s.formatMessage({id:"components.notification.title.error",defaultMessage:"\u9519\u8BEF"}),s.formatMessage({id:"api.accesskey.listAccessKeys.failed",defaultMessage:"\u83B7\u53D6\u7528\u6237Access Key\u6570\u636E\u5931\u8D25\uFF0C\u8BF7\u5237\u65B0\u9875\u9762\uFF0C\u91CD\u65B0\u5C1D\u8BD5\u3002\u72B6\u6001\u7801\uFF1A{code}({text})"},{code:_.code,text:_.message}),_,s);case 22:return a.abrupt("return",{data:[]});case 23:case"end":return a.stop()}},r,null,[[0,18]])}));return function(){return d.apply(this,arguments)}}(),b=function(r){var e=r.keyId;m.includes(e)?R(m.filter(function(i){return i!=e})):R([].concat(h()(m),[e]))},H=function(){var d=y()(u()().mark(function r(e){var i;return u()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,p({detailedResponse:!0});case 2:i=c.sent,g.a.deleteAccessKey(e.keyId,{withCredentials:!0,headers:{Authorization:"Bearer "+i.id_token}}).then(function(a){var o;(0,f.Ii)("success",s.formatMessage({id:"components.notification.title.success",defaultMessage:"\u6210\u529F"}),s.formatMessage({id:"api.accesskey.deleteAccessKey.success",defaultMessage:"\u6210\u529F\u5220\u9664Access Key {keyId}\u3002"},{keyId:e.keyId})),l==null||(o=l.current)===null||o===void 0||o.reload()}).catch(function(a){var o=a;(0,f.hA)(s.formatMessage({id:"components.notification.title.error",defaultMessage:"\u9519\u8BEF"}),s.formatMessage({id:"api.accesskey.deleteAccessKey.success.failed",defaultMessage:"\u5220\u9664Access Key {keyId} \u5931\u8D25\u3002"},{keyId:e.keyId}),o,s)});case 4:case"end":return c.stop()}},r)}));return function(e){return d.apply(this,arguments)}}(),J=function(){var d=y()(u()().mark(function r(e){var i;return u()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,p({detailedResponse:!0});case 2:i=c.sent,g.a.disableAccessKey(e.keyId,{withCredentials:!0,headers:{Authorization:"Bearer "+i.id_token}}).then(function(a){var o;(0,f.Ii)("success",s.formatMessage({id:"components.notification.title.success",defaultMessage:"\u6210\u529F"}),s.formatMessage({id:"api.accesskey.disableAPIKey.success",defaultMessage:"\u6210\u529F\u7981\u7528Access Key {keyId}\u3002"},{keyId:e.keyId})),l==null||(o=l.current)===null||o===void 0||o.reload()}).catch(function(a){var o=a;(0,f.hA)(s.formatMessage({id:"components.notification.title.error",defaultMessage:"\u9519\u8BEF"}),s.formatMessage({id:"api.accesskey.disableAPIKey.failed",defaultMessage:"\u7981\u7528Access Key {keyId} \u5931\u8D25\u3002"},{keyId:e.keyId}),o,s)});case 4:case"end":return c.stop()}},r)}));return function(e){return d.apply(this,arguments)}}(),N=function(){var d=y()(u()().mark(function r(e){var i;return u()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,p({detailedResponse:!0});case 2:i=c.sent,g.a.enableAccessKey(e.keyId,{withCredentials:!0,headers:{Authorization:"Bearer "+i.id_token}}).then(function(a){var o;(0,f.Ii)("success",s.formatMessage({id:"components.notification.title.success",defaultMessage:"\u6210\u529F"}),s.formatMessage({id:"api.accesskey.enableAPIKey.success",defaultMessage:"\u6210\u529F\u542F\u7528Access Key {keyId}\u3002"},{keyId:e.keyId})),l==null||(o=l.current)===null||o===void 0||o.reload()}).catch(function(a){var o=a;(0,f.hA)(s.formatMessage({id:"components.notification.title.error",defaultMessage:"\u9519\u8BEF"}),s.formatMessage({id:"api.accesskey.enableAPIKey.failed",defaultMessage:"\u542F\u7528Access Key {keyId} \u5931\u8D25\u3002"},{keyId:e.keyId}),o,s)});case 4:case"end":return c.stop()}},r)}));return function(e){return d.apply(this,arguments)}}(),Q=[{title:s.formatMessage({id:"model.accesskey.keyId",defaultMessage:"Access Key ID"}),dataIndex:"keyId",key:"keyId",width:"30%",search:!1,render:function(r,e){return[(0,n.jsx)("div",{children:e.keyId},"accessKey")]}},{title:s.formatMessage({id:"model.accesskey.keySecret",defaultMessage:"Access Key Secret"}),dataIndex:"keySecret",key:"keySecret",search:!1,width:"30%",render:function(r,e){return[(0,n.jsxs)("div",{children:[m.includes(e.keyId)&&e.keySecret,!m.includes(e.keyId)&&"********************************","\xA0",m.includes(e.keyId)&&(0,n.jsxs)(E.Z,{title:s.formatMessage({id:"pages.accesskey.action.hide.tooltip"}),children:[" ",(0,n.jsx)("a",{onClick:function(){return b(e)},children:s.formatMessage({id:"pages.accesskey.action.hide",defaultMessage:"\u9690\u85CF"})})]}),!m.includes(e.keyId)&&(0,n.jsxs)(E.Z,{title:s.formatMessage({id:"pages.accesskey.action.show.tooltip"}),children:[" ",(0,n.jsx)("a",{onClick:function(){return b(e)},children:s.formatMessage({id:"pages.accesskey.action.show",defaultMessage:"\u663E\u793A"})})]})]},"keySecret")]}},{title:s.formatMessage({id:"model.accesskey.state",defaultMessage:"\u72B6\u6001"}),dataIndex:"state",key:"state",search:!1,render:function(r,e){return[(0,n.jsx)("div",{children:s.formatMessage({id:"model.accesskey.state."+e.state})},"state")]}},{title:s.formatMessage({id:"model.accesskey.createAt",defaultMessage:"\u521B\u5EFA\u65F6\u95F4"}),dataIndex:"createAt",key:"createAt",width:"160px",search:!1,render:function(r,e){return[(0,n.jsx)("div",{children:(0,S.p6)(e.createdAt)},"createAt")]}},{title:s.formatMessage({id:"title.action",defaultMessage:"\u64CD\u4F5C"}),width:"160px",key:"action",search:!1,render:function(r,e){return[(0,n.jsxs)(T.Z,{size:"middle",children:[e.state=="enabled"&&(0,n.jsx)(k.Z,{title:(0,n.jsxs)("div",{children:[s.formatMessage({id:"pages.accesskey.action.disableAPIKey.confirmmessage",defaultMessage:"\u8BF7\u786E\u8BA4\u7981\u7528Access Key {keyId}?"},{keyId:e.keyId}),(0,n.jsx)("p",{}),(0,n.jsxs)(D.Z,{children:[" ",s.formatMessage({id:"pages.accesskey.action.disableAPIKey.impact"})," "]})]}),onConfirm:function(){return J(e)},placement:"topRight",children:(0,n.jsx)("a",{children:s.formatMessage({id:"pages.accesskey.action.disableAPIKey",defaultMessage:"\u7981\u7528"})})}),e.state=="disabled"&&(0,n.jsx)("a",{onClick:function(){return N(e)},children:s.formatMessage({id:"pages.accesskey.action.enableAPIKey",defaultMessage:"\u542F\u7528"})}),(0,n.jsx)(k.Z,{title:(0,n.jsxs)("div",{children:[s.formatMessage({id:"pages.accesskey.action.deleteAPIKey.confirmmessage",defaultMessage:"\u8BF7\u786E\u8BA4\u5220\u9664Access Key {keyId}?"},{keyId:e.keyId}),(0,n.jsx)("p",{}),(0,n.jsxs)(D.Z,{children:[" ",s.formatMessage({id:"pages.accesskey.action.deleteAPIKey.impact"})," "]})]}),onConfirm:function(){return H(e)},placement:"topRight",children:(0,n.jsx)("a",{children:s.formatMessage({id:"pages.accesskey.action.deleteAPIKey",defaultMessage:"\u5220\u9664"})})})]},"actions")]}}];return(0,n.jsx)(W._z,{children:(0,n.jsx)(L.Z,{columns:Q,actionRef:l,cardBordered:!0,request:G,rowKey:function(r){return r.id},columnsState:{persistenceKey:"wiseinf-portal-apikey",persistenceType:"localStorage",onChange:function(r){}},search:!1,options:{setting:{listsHeight:600}},pagination:{pageSize:10},dateFormatter:"string",toolBarRender:function(){return[(0,n.jsx)(U.ZP,{icon:(0,n.jsx)(Z.Z,{}),onClick:F,type:"primary",children:s.formatMessage({id:"btn.new"})},"button")]}})})};M.default=(0,O.u3)(C)}}]);
