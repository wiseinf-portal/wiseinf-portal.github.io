"use strict";(self.webpackChunkportal=self.webpackChunkportal||[]).push([[147],{72520:function(H,y,r){r.r(y),r.d(y,{AccessKeyPage:function(){return p}});var P=r(67855),k=r.n(P),D=r(13448),m=r.n(D),C=r(74815),O=r.n(C),j=r(28152),R=r.n(j),M=r(19496),b=r(92790),g=r(26768),T=r(96762),B=r(36803),x=r(26245),A=r(60822),f=r(9034),U=r(25624),l=r(64619),I=r(93236),W=r(37632),v=r(87254),i=r(62086),p=function(){var s=(0,A.useIntl)(),L=(0,A.useModel)("@@initialState"),o=L.initialState,n=(0,I.useRef)(),S=(0,I.useState)([]),h=R()(S,2),_=h[0],K=h[1],Z=function(){f.a.createAccessKey({withCredentials:!0,headers:{Authorization:"Bearer "+(o==null?void 0:o.accessToken)}}).then(function(t){var e;(0,l.Ii)("success",s.formatMessage({id:"components.notification.title.success",defaultMessage:"\u6210\u529F"}),s.formatMessage({id:"api.accesskey.createAccessKey.success",defaultMessage:"\u6210\u529F\u521B\u5EFAAccess Key\u3002"})),n==null||(e=n.current)===null||e===void 0||e.reload()}).catch(function(t){var e,a=t;(0,l.hA)(s.formatMessage({id:"components.notification.title.error",defaultMessage:"\u9519\u8BEF"}),s.formatMessage({id:"api.accesskey.createAccessKey.failed",defaultMessage:"\u521B\u5EFAAccess Key \u5931\u8D25\u3002"}),a,s),n==null||(e=n.current)===null||e===void 0||e.reload()})},$=function(){var d=O()(m()().mark(function t(){var e,a;return m()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,f.a.listAccessKeys({withCredentials:!0,headers:{Authorization:"Bearer "+(o==null?void 0:o.accessToken)}});case 3:if(e=c.sent,e.status!=200){c.next=12;break}if(!(e.data.length>0)){c.next=9;break}return c.abrupt("return",{data:e.data});case 9:return c.abrupt("return",{data:[]});case 10:c.next=13;break;case 12:(0,l.Ii)("error",s.formatMessage({id:"components.notification.title.error",defaultMessage:"\u9519\u8BEF"}),s.formatMessage({id:"api.accesskey.listAccessKeys.failed",defaultMessage:"\u83B7\u53D6\u7528\u6237Access Key\u6570\u636E\u5931\u8D25\uFF0C\u8BF7\u5237\u65B0\u9875\u9762\uFF0C\u91CD\u65B0\u5C1D\u8BD5\u3002\u72B6\u6001\u7801\uFF1A{code}({text})"},{code:e.status,text:e.statusText}));case 13:c.next=19;break;case 15:c.prev=15,c.t0=c.catch(0),a=c.t0,(0,l.hA)(s.formatMessage({id:"components.notification.title.error",defaultMessage:"\u9519\u8BEF"}),s.formatMessage({id:"api.accesskey.listAccessKeys.failed",defaultMessage:"\u83B7\u53D6\u7528\u6237Access Key\u6570\u636E\u5931\u8D25\uFF0C\u8BF7\u5237\u65B0\u9875\u9762\uFF0C\u91CD\u65B0\u5C1D\u8BD5\u3002\u72B6\u6001\u7801\uFF1A{code}({text})"},{code:a.code,text:a.message}),a,s);case 19:return c.abrupt("return",{data:[]});case 20:case"end":return c.stop()}},t,null,[[0,15]])}));return function(){return d.apply(this,arguments)}}(),E=function(t){var e=t.keyId;_.includes(e)?K(_.filter(function(a){return a!=e})):K([].concat(k()(_),[e]))},w=function(t){f.a.deleteAccessKey(t.keyId,{withCredentials:!0,headers:{Authorization:"Bearer "+(o==null?void 0:o.accessToken)}}).then(function(e){var a;(0,l.Ii)("success",s.formatMessage({id:"components.notification.title.success",defaultMessage:"\u6210\u529F"}),s.formatMessage({id:"api.accesskey.deleteAccessKey.success",defaultMessage:"\u6210\u529F\u5220\u9664Access Key {keyId}\u3002"},{keyId:t.keyId})),n==null||(a=n.current)===null||a===void 0||a.reload()}).catch(function(e){var a,u=e;(0,l.hA)(s.formatMessage({id:"components.notification.title.error",defaultMessage:"\u9519\u8BEF"}),s.formatMessage({id:"api.accesskey.deleteAccessKey.success.failed",defaultMessage:"\u5220\u9664Access Key {keyId} \u5931\u8D25\u3002"},{keyId:t.keyId}),u,s),n==null||(a=n.current)===null||a===void 0||a.reload()})},z=function(t){f.a.disableAccessKey(t.keyId,{withCredentials:!0,headers:{Authorization:"Bearer "+(o==null?void 0:o.accessToken)}}).then(function(e){var a;(0,l.Ii)("success",s.formatMessage({id:"components.notification.title.success",defaultMessage:"\u6210\u529F"}),s.formatMessage({id:"api.accesskey.disableAPIKey.success",defaultMessage:"\u6210\u529F\u7981\u7528Access Key {keyId}\u3002"},{keyId:t.keyId})),n==null||(a=n.current)===null||a===void 0||a.reload()}).catch(function(e){var a,u=e;(0,l.hA)(s.formatMessage({id:"components.notification.title.error",defaultMessage:"\u9519\u8BEF"}),s.formatMessage({id:"api.accesskey.disableAPIKey.failed",defaultMessage:"\u7981\u7528Access Key {keyId} \u5931\u8D25\u3002"},{keyId:t.keyId}),u,s),n==null||(a=n.current)===null||a===void 0||a.reload()})},G=function(t){f.a.enableAccessKey(t.keyId,{withCredentials:!0,headers:{Authorization:"Bearer "+(o==null?void 0:o.accessToken)}}).then(function(e){var a;(0,l.Ii)("success",s.formatMessage({id:"components.notification.title.success",defaultMessage:"\u6210\u529F"}),s.formatMessage({id:"api.accesskey.enableAPIKey.success",defaultMessage:"\u6210\u529F\u542F\u7528Access Key {keyId}\u3002"},{keyId:t.keyId})),n==null||(a=n.current)===null||a===void 0||a.reload()}).catch(function(e){var a,u=e;(0,l.hA)(s.formatMessage({id:"components.notification.title.error",defaultMessage:"\u9519\u8BEF"}),s.formatMessage({id:"api.accesskey.enableAPIKey.success.failed",defaultMessage:"\u542F\u7528Access Key {keyId} \u5931\u8D25\u3002"},{keyId:t.keyId}),u,s),n==null||(a=n.current)===null||a===void 0||a.reload()})},F=[{title:s.formatMessage({id:"model.accesskey.keyId",defaultMessage:"Access Key ID"}),dataIndex:"keyId",key:"keyId",width:"30%",search:!1,render:function(t,e){return[(0,i.jsx)("div",{children:e.keyId},"accessKey")]}},{title:s.formatMessage({id:"model.accesskey.keySecret",defaultMessage:"Access Key Secret"}),dataIndex:"keySecret",key:"keySecret",search:!1,width:"30%",render:function(t,e){return[(0,i.jsxs)("div",{children:[_.includes(e.keyId)&&e.keySecret,!_.includes(e.keyId)&&"********************************","\xA0",_.includes(e.keyId)&&(0,i.jsxs)(M.Z,{title:s.formatMessage({id:"pages.accesskey.action.hide.tooltip"}),children:[" ",(0,i.jsx)("a",{onClick:function(){return E(e)},children:s.formatMessage({id:"pages.accesskey.action.hide",defaultMessage:"\u9690\u85CF"})})]}),!_.includes(e.keyId)&&(0,i.jsxs)(M.Z,{title:s.formatMessage({id:"pages.accesskey.action.show.tooltip"}),children:[" ",(0,i.jsx)("a",{onClick:function(){return E(e)},children:s.formatMessage({id:"pages.accesskey.action.show",defaultMessage:"\u663E\u793A"})})]})]},"keySecret")]}},{title:s.formatMessage({id:"model.accesskey.state",defaultMessage:"\u72B6\u6001"}),dataIndex:"state",key:"state",search:!1,render:function(t,e){return[(0,i.jsx)("div",{children:s.formatMessage({id:"model.accesskey.state."+e.state})},"state")]}},{title:s.formatMessage({id:"model.accesskey.createAt",defaultMessage:"\u521B\u5EFA\u65F6\u95F4"}),dataIndex:"createAt",key:"createAt",width:"160px",search:!1,render:function(t,e){return[(0,i.jsx)("div",{children:(0,U.p6)(e.createdAt)},"createAt")]}},{title:s.formatMessage({id:"title.action",defaultMessage:"\u64CD\u4F5C"}),width:"160px",key:"action",search:!1,render:function(t,e){return[(0,i.jsxs)(b.Z,{size:"middle",children:[e.state=="enabled"&&(0,i.jsx)(g.Z,{title:(0,i.jsxs)("div",{children:[s.formatMessage({id:"pages.accesskey.action.disableAPIKey.confirmmessage",defaultMessage:"\u8BF7\u786E\u8BA4\u7981\u7528Access Key {keyId}?"},{keyId:e.keyId}),(0,i.jsx)("p",{}),(0,i.jsxs)(v.Z,{children:[" ",s.formatMessage({id:"pages.accesskey.action.disableAPIKey.impact"})," "]})]}),onConfirm:function(){return z(e)},placement:"topRight",children:(0,i.jsx)("a",{children:s.formatMessage({id:"pages.accesskey.action.disableAPIKey",defaultMessage:"\u7981\u7528"})})}),e.state=="disabled"&&(0,i.jsx)("a",{onClick:function(){return G(e)},children:s.formatMessage({id:"pages.accesskey.action.enableAPIKey",defaultMessage:"\u542F\u7528"})}),(0,i.jsx)(g.Z,{title:(0,i.jsxs)("div",{children:[s.formatMessage({id:"pages.accesskey.action.deleteAPIKey.confirmmessage",defaultMessage:"\u8BF7\u786E\u8BA4\u5220\u9664Access Key {keyId}?"},{keyId:e.keyId}),(0,i.jsx)("p",{}),(0,i.jsxs)(v.Z,{children:[" ",s.formatMessage({id:"pages.accesskey.action.deleteAPIKey.impact"})," "]})]}),onConfirm:function(){return w(e)},placement:"topRight",children:(0,i.jsx)("a",{children:s.formatMessage({id:"pages.accesskey.action.deleteAPIKey",defaultMessage:"\u5220\u9664"})})})]},"actions")]}}];return(0,i.jsx)(B._z,{children:(0,i.jsx)(x.Z,{columns:F,actionRef:n,cardBordered:!0,request:$,rowKey:function(t){return t.id},columnsState:{persistenceKey:"wiseinf-portal-apikey",persistenceType:"localStorage",onChange:function(t){}},search:!1,options:{setting:{listsHeight:600}},pagination:{pageSize:10},dateFormatter:"string",toolBarRender:function(){return[(0,i.jsx)(T.ZP,{icon:(0,i.jsx)(W.Z,{}),onClick:Z,type:"primary",children:s.formatMessage({id:"btn.new"})},"button")]}})})};y.default=p}}]);
